# Rime schema
# encoding: utf-8

schema:
  author:
    - Hertz Hwang <hertz@26hz.com.cn>
  dependencies:
    - charset
    - pinyin
    - fast_symbol
    - tiger_spelling_pseudo
    - radical_flypy
    - easy_en
    - japanese
    - tiger_codes
    - tiger_oni
    - tiger_phrases
  description: |
    赫兹虎单整句
  name: "🐯句·单"
  schema_id: tiger_phrase
  version: "2024-11-16"

__patch:
  - tiger_code.custom:/patch?
  - engine/processors/@next: lua_processor@*hertz.tiger_pin*pin_processor
  - engine/translators/@next: lua_translator@*hertz.tiger_pin*panacea_translator
  - engine/filters/@next: lua_filter@*hertz.tiger_pin*pin_filter
  - engine/filters/@next: simplifier@chinese_english
  - engine/filters/@next: lua_filter@*hertz.tiger_spelling*filter

__include: tiger:/switches_engine_script       # Rime模块
__include: tiger:/fast_symbol_translator       # 快符
__include: tiger:/tiger_phrase_translator      # 赫兹虎单整句
__include: tiger:/reverse_lookup_translator_xh # 小鹤反查
__include: tiger:/s2t_filter                   # 简繁滤镜
__include: tiger:/history_filter               # z 键历史
__include: tiger:/emoji_filter                 # Emoji 滤镜
__include: tiger:/cn_en_filter                 # 中英滤镜
__include: tiger:/mars_filter                  # 火星文滤镜
__include: tiger:/embeded_cands_filter         # 候选嵌入
__include: tiger:/hertz                        # Hertz定制

speller:
  auto_clear: max_length
  auto_select: true
  max_code_length: 5
  alphabet: ";'zyxwvutsrqponmlkjihgfedcbaUPOI[]/V"
  delimiter: "_'"
  auto_select_pattern: ^;\w+
  algebra:
    __patch:
      #- tiger:/algebra/core?        # 核心拼算
      - tiger:/algebra/phrase      # 整句拼算
      - tiger:/algebra/erase       # 擦除编码

translator:
  __include: tiger:/dicts
  enable_user_dict: true
  enable_charset_filter: false
  enable_encoder: false
  enable_sentence: false
  encode_commit_history: false
  enable_completion: false
  preedit_format:
    # 手动分词标记
    - xform/([a-z]{4})[P']/$1⁴/
    - xform/([a-z]{3})[O']/$1³/
    - xform/([a-z]{2})[I']/$1²/
    - xform/([a-z]{1})[U']/$1¹/
    # 自动分词标记
    - xform/([a-z]{1,4})[_]/$1␣/
    # 其余处理
    - xform/([¹²³⁴][a-z]+)[_']/$1/
    - xform/([¹²³⁴])_/$1/

key_binder:
  import_preset: default
  custom_bindings:
    __append:
      # 在這裏添加只在本方案中生效的按鍵綁定
  bindings:
    __patch:
      - :/key_binder/custom_bindings?
      - tiger:/keys/emacs_mode
      - tiger:/keys/tab
      - tiger:/keys/page_up_down
      - tiger:/keys/selector
      - tiger:/keys/options_toggle

__include: tiger:/rec

punctuator:
  #import_preset:
  __include: tiger:/punctuator

# 默认启用语言模型
__include: tiger:/octagram/enable_for_chars
# 若要禁用，可直接注释掉上面的 __include

tiger_spelling:
  lua:
    switch_key: "Control+c"
    cycle_key: "Shift+Control+C"
schema_name:
  spelling: tiger_spelling_pseudo
  code: tiger_phrase

tiger:
  # 「置頂」功能相關設置
  # 輸入時通過快捷鍵 Ctrl+t 可以將高亮顯示的候選置頂，被置頂的候選位置固定，不再參與調頻
  # 對同一輸入碼最高支持8個置頂詞，當嘗試置頂第9個詞時，最早被置頂的詞將會失效
  pin:
    # 「置頂」功能開關
    enable: true
    # 置頂詞提示符
    indicator: "📌"
    # 「萬靈藥」加詞功能
    # 通過輸入 「編碼A」@「編碼B」 實現造詞功能，編碼A是這個新詞的新編碼 編碼B是目前可以打出該詞的編碼
    # 例如 輸入 tnfb 不能得到「頭腦風暴」這一候選， 此時我們可以輸入 tnfb@tbnkfgbk 按下空格 讓「頭腦風暴」候選上屏，上屏的詞會被加入用戶詞庫中，之後我們可以用 tnfb 來得到「頭腦風暴」這一候選了
    # 造出的詞與置頂詞是等同的
    panacea:
      # 加詞狀態提示
      prompt: "〔造词〕"
      # 加詞中綴引導符
      infix: "@"
      # 自由加詞模式開關，開啓此模式後，輸入「編碼A」@並空格上屏後會進入加詞狀態，此時可以連續地、不受束縛地輸入，再次按下x@空格退出加詞狀態，期間輸入的內容將會被記錄爲「編碼A」的新置頂詞
      # 此模式適合造一些混合詞，如「A4紙」、「KOS-MOS」等
      freestyle: true